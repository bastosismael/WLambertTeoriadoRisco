---
title: "WLambert"
output: html_document
header-includes:
  - \usepackage{subcaption}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("lamW")
```


# Função W de Lambert

Para entender a função W de Lambert, primeiramente precisamos compreender o conceito de função inversa. 

## Função Inversa

Seja uma função $f: A \rightarrow B$, podemos definir uma função $f^{-1}: B \rightarrow A$ a qual chamaremos de função inversa de $f$. 



```{r echo=FALSE, out.width = '50%', fig.align="center"}
knitr::include_graphics(c("images/f_inversa.png"))
```

Basicamente, $f^{-1}$ desfaz o que $f$ cria.É importante ressaltar que estamos admitindo a existência da função inversa, no entanto, nem sempre isso é possível. Por exemplo, seja $f: A \rightarrow B$, em que $f(x)$ é representada através da imagem abaixo:

```{r echo=FALSE, out.width = '25%', fig.align="center"}
knitr::include_graphics(c("images/nao_injetiva.png"))
```

Temos que, $f(x) = f(y) = a$, no entanto,  $f^{-1}(a)$ não pode ser simultaneamente $x$ e $y$, pois não é permitido que existam ambiguidades, trata-se de um absurdo. Analisando $f$, é notório que trata-se de uma função não-injetiva, com isso, é possível chegar a conclusão que se a função não for injetiva, então não é possível obter sua inversa.

Ainda nesse sentido, poderíamos ter a seguinte situação: Seja $f: A \rightarrow B$, em que $f(x)$ é representada através do esquema abaixo:


```{r echo=FALSE, out.width = '25%', fig.align="center"}
knitr::include_graphics(c("images/nao_sobrejetiva.png"))
```

É possível perceber que $c \in B$, mas não existe $f^{-1}(c)$, portanto, nesse caso também não existiria $f^{-1}$, ou seja, $f$ não possui inversa, pois, pela definição de função, não podem haver exceções em relação ao seu domínio. Podemos extrapolar essa noção e afirmar que, sempre que tivermos uma função que não é sobrejetiva, então ela não possuirá inversa.

Com isso, é possível estabelecer dois criteŕios para que uma função possua inversa:

<style>
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">

- A função é injetiva
- A função é sobrejetiva

</div>


Logo, se uma função é injetiva e sobrejetiva, ela é bijetiva, o que nos leva a seguinte conclusão:

<style>
div.red{ background-color:#ffcccc; border-radius: 5px; padding: 20px;}
</style>
<div class = "red">

**Uma função só admite inversa caso seja bijetiva.**

</div>

### Exemplo 1:

Seja $f: \mathbb{R} \rightarrow \mathbb{R}$ tal que $f(x) = e^x$, determine $f^{-1}$.




A função f é injetiva, se $\forall \ x_1, x_2 \in \mathbb{R}$ temos que $f(x_1) = f(x_2) \implies x_1 = x_2$

\begin{gather*}
f(x_1) = e^{x_1}\\
f(x_2) = e^{x_2}
\end{gather*}

\begin{align*}
f(x_1) &= f(x_2)\\
e^{x_1} &= e^{x^2}\\
ln(e^{x_1}) &= ln(e^{x_1})\\
x_1 &= x_2
\end{align*}

Com isso, demonstramos que f é injetiva. Para demonstrar que é sobrejetiva temos que demonstrar que:
\begin{equation}
\forall y \in \mathbb{R}, \exists x \in \mathbb{R}, \text{ tal que } f(x) = y.
\end{equation}

\begin{gather*}
y = e^x\\
x = ln(y)\\
\end{gather*}

\begin{align*}
f(x) &= f(ln(y))\\
&= e^{ln(y)}\\
&= y
\end{align*}

Logo, $f$ é bijetiva e, portanto, admite inversa.

Admitindo $f(x) = y$, para obter $f^{-1}$, basta trocar $x$ por $y$

\begin{gather*}
y = e^x\\
x = e^y\\
y = ln(x)
\end{gather*}

Portanto, podemos afirmar que $f^{-1}: \mathbb{R} \rightarrow \mathbb{R}$ é definida por $f^{-1}(x) =ln(x)$.

### Exemplo 2

Seja $f: \mathbb{R} \rightarrow \mathbb{R}$ tal que $f(x) = x^2$, determine $f^{-1}$.

Uma forma bem simples de verificar se f é injetiva é realizar o teste da reta horizontal, que consiste em traçar uma reta horizontal no gráfico da função análisada.

```{r echo=FALSE, fig.align='center'}
curve(x^2, from=-10, to=10, , xlab="x", ylab="y")
abline(h=20, col="red")
```

Como a reta horizontal toca a função em dois pontos distintos, o que mostra que a função não é injetiva. Da mesma forma, é possível verificar que $f(-2)=f(2) =4$, de forma geral, $f(x) = f(-x) = x^2$. Como $f$ não é injetiva, segue que também não é bijetiva e portanto não possui inversa.

Entretanto, se alterarmos o domínio de $f$, podemos fazer com que ela possua inversa. Vamos considerar agora o seguinte problema: Seja $f: \mathbb{R^+} \rightarrow \mathbb{R^+}$ de forma que $f(x) = x^2$, determine $f^{-1}$.

Realizando novamente o teste da reta horizontal, é possível verificar que a reta toca em apenas um ponto, o ponto y=20 foi escolhido de forma arbitraria, mas é possível notar que qualquer outra reta horizontal $y=h$ com $h \in \mathbb{R^+} iria tocar em apenas um ponto da mesma maneira.

```{r echo=FALSE, fig.align='center'}

plot(x = seq(0,10,0.1), y = seq(0,10,0.1)^2, xlim = c(-10,10), type='l', xlab = "x", ylab = "y")
abline(h=20, col="red")
```

Ainda é possível demonstrar que $f$ é injetiva:

Seja $x_1, x_2\ \in \mathbb{R^+}$, então:
\begin{gather*}
f(x_1) = x_1^2\\
f(x_2) = x_2^2
\end{gather*}

\begin{align*}
f(x_1) &= f(x_2)\\
x_1^2 &= x_2^2\\
\sqrt{x_1^2} &= \sqrt{x_2^2}\\
x_1 &= x_2
\end{align*}

portanto, $f$ é injetiva.

Para verificar que é sobrejetiva basta ver que:

\begin{align*}
y &= x^2\\
x &= \sqrt{y}\\
f(\sqrt{y}) &= \sqrt{y}^2\\
f(\sqrt{y}) &= y\\
\end{align*}

Logo, $f$ é bijetiva e portanto possui inversa:

\begin{align*}
y &= x^2\\
x &= y^2\\
y &= \sqrt{x}
\end{align*}

Portanto, podemos afirmar que $f^{-1}: \mathbb{R^+} \rightarrow \mathbb{R^+}$ é definida por $f^{-1}(x) =\sqrt{x}$.

Um racicínio análogo poderia ser feito para $f: \mathbb{R^-} \rightarrow \mathbb{R^+}.

## Função W de Lambert

Começaremos nosso estudo através da função $f: \mathbb{R} \rightarrow \mathbb{R}$, definida por:

\begin{equation}
 f(x) = xe^x
\end{equation}

```{r echo=FALSE, fig.align='center'}

f <- function(x) return(x*exp(x))
curve(f, from=-8, to=1, ylab="y")
abline(h=-0.25, col="red")
```

Pela visualização de seu gráfico é evidente que trata-se de uma função não-injetiva, portanto, não possui inversa, podendo ser visto pelo teste da reta horizontal.

Portanto, $f$ não é bijetiva. No entanto, assim como ocorre para a função $f(x) = x^2$ é possível delimitar seu domínio e obter funções invertiveis, no caso de $f(x) = xe^x$ podemos realizar uma abordagem semelhante.

É possível verificar, através da primeira derivada de $f$, que $x=-1$ é um mínimo global e que $f'(x)>0,\quad x>-1$. Da mesma forma $f'(x)<0,\quad x<-1$.

Logo, é possível notar que $f: [-1, \infty) \rightarrow [-1/e, \infty)$ tal que $f(x) = xe^x$ é injetiva. Assim como $g: (-\infty, -1] \rightarrow (-1/e, 0)$ com $g(x)= xe^x$ também é injetiva.

Também é possível verificar que $f$ e $g$ são sobrejetivas, utilizando-se para isso, o teorema do valor médio.

Por fim, sabemos que $f$ e $g$ são bijetivas e, portanto, possuem inversa. 

A inversa de $f$ é denotada por $W_{0}$ e é chamada de função $W$ de Lambert no ramo $0$. De forma equivalente, a inversa de $g$ é denotada por $W_{-1}$ e é denominada função $W$ de Lambert no ramo $-1$.

O gráfico abaixo apresenta a função $W$ de lambert nos ramos $-1$ e $0$, assim como as funções $f$ e $g$:

```{r echo=FALSE, out.width = '50%', fig.align="center"}
knitr::include_graphics(c("images/inversas.png"))
```

# Calcular a função W de Lambert em um ponto

Para explicar como avaliar a função W de lambert em um ponto específico, partiremos do seguinte exemplo:

**Exemplo**: Determine $x$ que satisfaça a seguinte equação:
\begin{equation}
2^x = 10x
\end{equation}

Para resolver esse problema, podemos realizar os seguintes passos:
\begin{align*}
ln(2^x) &= ln(10x )\\
xln(2) &= ln(10x)\\
e^{xln(2)} &= 10x\\
xe^{-xln(2)} &= \dfrac{1}{10}\\
-x\ln{(2)}e^{-xln(2)} &= -\dfrac{\ln{(2)}}{10}
\end{align*}

Nesse ponto, é possível verificar o surgimento da expressão : $-x\ln{(2)}e^{-xln(2)}$.

Um ponto importante sobre inversas é que:

[Imagem]

Logo, temos a seguinte identidade:
\begin{equation}
W(xe^x) = x
\end{equation}
